/**
* Javascript Templating Engine (Selector Styles) - A New Way To Deal With Templates 
* The MIT License - Copyright (c) 2013 Hongbo Yang <abcrun@gmail.com>
* Repository - https://github.com/abcrun/whiskers.git
* Version - 0.3.0
*/(function(e,t){typeof define=="function"&&define.amd?define(t):typeof module=="object"&&module.exports?module.exports=t():this[e]=t()})("Whiskers",function(){var e="[\\x20\\t\\r\\n\\f]",t="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",n="\\{\\{=(\\$?"+t.replace("w","w\\[\\]\\.\\*'\"")+")\\}\\}",r=new RegExp(n.replace("?",""),"g"),i=new RegExp("(\\$"+t.replace("w","w\\[\\]\\.\\*'\"")+")","g"),s=new RegExp("#("+t+")"),o=new RegExp("\\.("+t+"|"+n+")"),u=new RegExp("\\["+e+"*("+t+")"+e+"*="+e+"*((?:"+n.replace("?","")+"|"+t.replace("w","w\\.\"'")+"))"+e+"*\\]"),a=new RegExp("^"+e+"*\\(((?:\\\\.|[^\\\\])*)\\)"+e+"*"),f=new RegExp("^"+e+"*"+"("+"(?:\\\\.|[^\\\\()])+"+")"+e+"*>"+e+"*("+"(?:\\\\.|[^\\\\()>])+|\\((?:\\\\.|[^\\\\])+\\)"+")"+e+"*$"),l=new RegExp("^("+t+")|("+n+")"),c=function(e){var t=e.length,n=0,r=[],i=[];for(var s=0;s<t;s++){var o=e.charAt(s);o=="("&&n++,o==")"&&n--,(o=="+"&&n||o!="+")&&r.push(o),!n&&(o=="+"||s==t-1)&&(i.push(r.join("").replace(/(?:^\s+|\s+$)/,"")),n=0,r=[])}return i},h=function(e,t,n){var s=n?r:i;return e.replace(s,function(e,n){var r=n.match(/[^\[\]\.]+/g),i;if(r)while(r.length)i=(i||t)[r.shift()];return/(?:undefined|null)/.test(i)?e:i})},p=function(e,t){var n=s.exec(e),r,i,a=[];n&&(t.id=n[1]);while(e!=""){if(r=u.exec(e)){var f=r[1],l=r[2];t.setAttribute(f,l),e=e.replace(u,"")}else(i=o.exec(e))?(a.push(i[1]),e=e.replace(o,"")):e="";a.length&&(t.className=a.join(" "))}return t},d=function(t,n,i,s){var o,u=document.createDocumentFragment();!s&&n&&i&&i(n),r.test(t)&&!/\*/.test(t)&&n&&(t=h(t,n)),o=c(t);for(var v=0;v<o.length;v++){var m=o[v];if(a.test(m)){u.appendChild(d(m.replace(a,"$1"),n,i,!0));continue}var g=f.exec(m),y=descendant=null;g?(y=g[1],descendant=g[2]):y=m,descendant&&(descendant=d(descendant.replace(a,"$1"),n,i,!0));if(y){var b=y.split(">"),w=descendant||document.createDocumentFragment();while(b.length){var E=b.pop(),S,x,T="",N=1,C=0;S=E.replace(/\*(\d+)/,function(e,t){return t&&(N=parseInt(t)),""});if(x=l.exec(S))if(x[1])y=document.createElement(x[1]),y.appendChild(w),T=S.replace(new RegExp("^"+e+"*"+x[1]),""),T&&p(T,y);else{var k=x[2];r.test(k)||(k=x[3]),y=document.createTextNode(k)}if(N==1)w.appendChild(y);else{var L=y.nodeName,A=y.innerHTML,O=r.test(T),M=r.test(A),_=null;while(C!=N){if(n&&(O||M)){var D;_=document.createElement(L);if(O){var P=T.replace(/\*/g,C);D=h(P,n,!0),p(D,_)}if(M){var H=A.replace(/(\.|\[)\*(\.|\]|\})/g,"$1"+C+"$2");D=h(H,n,!0);if(window.ActiveXObject&&L.toLowerCase()=="tr"){var B=document.createElement("div");B.innerHTML="<table><tr>"+D+"</tr></table>";var j=B.getElementsByTagName("td");while(j.length)_.appendChild(j[0]);B=null}else _.innerHTML=D}}else _=y.cloneNode(!0);w.appendChild(_),C++}y=_=null}}}u.appendChild(w)}return u},v={};return v.render=d,v})
