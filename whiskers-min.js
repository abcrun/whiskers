/**
* Javascript Templating Engine (Selector Styles) - A New Way To Deal With Templates 
* The MIT License - Copyright (c) 2013 Hongbo Yang <abcrun@gmail.com>
* Repository - https://github.com/abcrun/whiskers.git
* Version - 0.4.1
*/(function(e,t){typeof define=="function"&&define.amd?define(t):typeof module=="object"&&module.exports?module.exports=t():this[e]=t()})("Whiskers",function(){var e="[\\x20\\t\\r\\n\\f]",t="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",n="\\{\\{=(\\$?"+t.replace("w","w\\[\\]\\.\\*'\" \\(\\)>\\+")+")\\}\\}",r=new RegExp(n.replace("?",""),"g"),i=new RegExp(n.replace("\\$?",""),"g"),s=new RegExp("#("+t+"|"+n+")"),o=new RegExp("\\.("+t+"|"+n+")"),u=new RegExp("\\["+e+"*("+t+")"+e+"*="+e+"*(['\"]?)((?:"+n.replace("?","")+"|"+t.replace("w","w\\.\"':\\/@;\\?&#()")+"))\\2"+e+"*\\]"),a=new RegExp("(?:\\["+e+"*"+t+e+"*="+e+"*[^\\]]+|\\{\\{=[^\\}]+)$"),f=new RegExp("^"+e+"*("+t+")|("+n+")"+e+"*"),l=function(e){var t=e.length,n=0,r=[],i=[],s=[],o,u=[];for(var f=0;f<t;f++){var h=e.charAt(f),p=!1;if(/[\(\)>\+]/.test(h)||(p=f==t-1)){var d=r.join("");if(a.test(d))r.push(h);else{h=="("&&n++,h==")"&&n--;if(n)(n==1&&h!="("||n!=1)&&r.push(h);else{if(h==")")i.push(l(d));else if(h==">"||h=="+"||f==t-1)p&&(d+=h),o=c(d),i.push(o[0]),s.unshift(o[1]),h=="+"&&(u.push(i.join("")+s.join("")),i=[],s=[]);r=[]}}}else r.push(h)}return u.push(i.join("")+s.join("")),u.join("")},c=function(e){var t=f.exec(e),n=[],r=[];if(!t)return["",""];var i=t[1],a=t[2];if(i){var l,c=s.exec(e),h,p,d=[];e.replace(/\*(\d+)/,function(e,t){return t&&(l=t),""}),l&&n.push(l+"*("),n.push("<"+i),c&&n.push("id="+c[1]);while(e!="")if(h=u.exec(e)){var v=h[1].toLowerCase(),m=h[3];v=="class"?d.push(m):n.push(v+"="+m),e=e.replace(u,"")}else(p=o.exec(e))?(d.push(p[1]),e=e.replace(o,"")):e="";d.length&&n.push('class="'+d.join(" ")+'"'),n.push(">"),r.unshift("</"+i+">"),l&&r.push(")*"+l)}else a&&(n.push(a),r.unshift(""));return[n.join(" "),r.join("")]},h=function(e,t,n){var s,o=/(\d+)\*\(((?:\\\\.|[^\\\\])+)\)\*\1/g;return t&&n&&n(t),s=l(e),s=s.replace(o,function(e,t,n){var r=t,i=n,s=[];for(var o=0;o<r;o++)s.push(i.replace(/\*/g,o));return s.join("")}),t&&(s=s.replace(r,function(e,n){var r=n.match(/[^\[\]\.]+/g),i;if(r)while(r.length)i=(i||t)[r.shift()];return/(?:undefined|null)/.test(i)?e:i})),s=s.replace(i,function(e,t){return t}),s},p=function(e){this.template=e||"",this.childNodes=[],this.results=[]};p.prototype={append:function(e){this.childNodes.push(e)},prepend:function(e){this.childNodes.unshift(e)},toString:function(){var e=this.template,t=this.childNodes,n=t.length;this.results=[],e&&this.results.push(e);if(t.length){var r=[],i;for(var s=0;s<n;s++){var o=t[s];o.childNodes&&o.childNodes.length?r.push(o.toString()):r.push(o.template||o)}if(i=r.length)r=i>1?"("+r.join("+")+")":r[0],this.results.push(r)}return this.results.join(">")}};var d={render:function(){var e=arguments;return typeof e[0]!="string"&&(e[0]=e[0].toString()),h.apply(this,e)},create:function(e){return new p(e)}};return d})
