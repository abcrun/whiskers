/**
* Javascript Templating Engine (Selector Styles) - A New Way To Deal With Templates 
* The MIT License - Copyright (c) 2013 Hongbo Yang <abcrun@gmail.com>
* Repository - https://github.com/abcrun/whiskers.git
* Version - 0.3.0
*/(function(e,t){typeof define=="function"&&define.amd?define(t):typeof module=="object"&&module.exports?module.exports=t():this[e]=t()})("Whiskers",function(){var e="[\\x20\\t\\r\\n\\f]",t="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",n="\\{\\{=(\\$?"+t.replace("w","w\\[\\]\\.\\*'\"")+")\\}\\}",r=new RegExp(n.replace("?","")),i=new RegExp(n.replace("?",""),"g"),s=new RegExp("(\\$"+t.replace("w","w\\[\\]\\.\\*'\"")+")","g"),o=new RegExp("#("+t+")"),u=new RegExp("\\.("+t+"|"+n+")"),a=new RegExp("\\["+e+"*("+t+")"+e+"*="+e+"*((?:"+n.replace("?","")+"|"+t.replace("w","w\\.\"'")+"))"+e+"*\\]"),f=new RegExp("^"+e+"*\\(((?:\\\\.|[^\\\\])*)\\)"+e+"*"),l=new RegExp("^"+e+"*"+"("+"(?:\\\\.|[^\\\\()])+"+")"+e+"*>"+e+"*("+"(?:\\\\.|[^\\\\()>])+|\\((?:\\\\.|[^\\\\])+\\)"+")"+e+"*$"),c=new RegExp("^"+e+"*("+t+")|("+n+")"+e+"*"),h=function(e){var t=e.length,n=0,r=[],i=[];for(var s=0;s<t;s++){var o=e.charAt(s);o=="("&&n++,o==")"&&n--,(o=="+"&&n||o!="+")&&r.push(o),!n&&(o=="+"||s==t-1)&&(i.push(r.join("").replace(/(?:^\s+|\s+$)/,"")),n=0,r=[])}return i},p=function(e,t,n){var r=n?i:s;return e.replace(r,function(e,n){var r=n.match(/[^\[\]\.]+/g),i;if(r)while(r.length)i=(i||t)[r.shift()];return/(?:undefined|null)/.test(i)?e:i})},d=function(e,t){var n=o.exec(e),r,i,s=[];n&&(t.id=n[1]);while(e!="")if(r=a.exec(e)){var f=r[1],l=r[2];t.setAttribute(f,l),e=e.replace(a,"")}else(i=u.exec(e))?(s.push(i[1]),e=e.replace(u,"")):e="";return s.length&&(t.className=s.join(" ")),t},v=function(t,n,i,s){var o,u=document.createDocumentFragment();!s&&n&&i&&i(n),r.test(t)&&!/\*/.test(t)&&n&&(t=p(t,n)),o=h(t);for(var a=0;a<o.length;a++){var m=o[a];if(f.test(m)){u.appendChild(v(m.replace(f,"$1"),n,i,!0));continue}var g=l.exec(m),y=descendant=null;g?(y=g[1],descendant=g[2]):y=m,descendant&&(descendant=v(descendant.replace(f,"$1"),n,i,!0));if(y){var b=y.split(">"),w=descendant||document.createDocumentFragment();while(b.length){var E=b.pop(),S,x,T="",N=1,C=0;S=E.replace(/\*(\d+)/,function(e,t){return t&&(N=parseInt(t)),""});if(x=c.exec(S))if(x[1])y=document.createElement(x[1]),y.appendChild(w),T=S.replace(new RegExp("^"+e+"*"+x[1]),""),T&&d(T,y);else{var k=x[2];r.test(k)||(k=x[3]),y=document.createTextNode(k)}if(N==1)w.appendChild(y);else{var L=y.nodeName,A=y.innerHTML,O=r.test(T),M=r.test(A),_=null;while(C!=N){if(n&&(O||M)){var D;if(O){var P=T.replace(/\*/g,C);_=document.createElement(L),D=p(P,n,!0),d(D,_)}else _=y.cloneNode(!0);if(M){var H=A.replace(/(\.|\[)\*(\.|\]|\})/g,"$1"+C+"$2");D=p(H,n,!0);if(window.ActiveXObject&&L.toLowerCase()=="tr"){var B=document.createElement("div");B.innerHTML="<table><tr>"+D+"</tr></table>";var j=B.getElementsByTagName("td");while(j.length)_.appendChild(j[0]);B=null}else _.innerHTML=D}}else _=y.cloneNode(!0);w.appendChild(_),C++}y=_=null}}}u.appendChild(w)}return u},m={};return m.render=v,m})
